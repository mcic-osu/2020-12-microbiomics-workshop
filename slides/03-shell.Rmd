---
title: "An Introduction to the shell"
author: "Jelmer Poelstra"
institute: "MCIC Wooster"
date: "2020/12/16 (updated: `r Sys.Date()`)"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

## What is a shell?

The shell is a command-line interface (CLI) to the operating system
for Unix-like operating systems, such as Linux and Mac.

(In Windows, there isn't really a shell, but there are [ways to get one](#windows-shell)).

--

<br>

There are many shell flavors that are mostly very similar.
The most common shell, and the default in Mac and Linux, is called **bash**.

We will also be working in a bash shell at OSC.

---

## But what does the shell do?

--

**The shell:**

- Provides a powerful way to manage and manipulate files.

--

- Is the most efficient (or only) way to run many programs
  and submit scripts, especially when dealing with bioinformatic data.

--

- Is the most efficient (or only) way to interact with remote
  computers such as OSC clusters.

--

- Makes it easy to keep *exact* track of all your actions.

---

## Let's open up a shell at OSC!

OSC allows us to use a shell within the browser at 
<https://ondemand.osc.edu/>

<br>

<p align = "center">
<img src=figs_shell/OSC_shell.png width="900">
</p>

<br>

- In the "`Clusters`" dropdown, Click "`Pitzer Shell Access`".


---

## Lots of welcome messages

<p align="left">
<img src=figs_shell/OSC_welcome.png width="600">
</p>

<p align="center">
<img src=figs_shell/OSC_welcome2.png width="900">
</p>

--

### And a **prompt**:

<p align="center">
<img src=figs_shell/OSC_prompt.png width="900">
</p>

---

## Everything you type is a command

.pull-left[
```{bash, error=TRUE}
cal
```
]

--

.pull-right[
```{bash}
cal -j   # Use OPTION "-j"
```
]

--

```{bash}
cal 2020 # Use ARGUMENT 2020 
```

---

## Interactive jobs on `SLURM`

- Start a 1-hour, single-core interactive job with a `bash` shell:
```sh
$ srun --nodes=1 --ntasks-per-node=1 --time=01:00:00 --pty bash -i
```

- Can also use `salloc` and `sinteractive`.

---

## Batch jobs on `SLURM`

- Unlike in `PBS`, job script needs to start with shebang line:
```sh
#!/bin/bash
```

- Submit a job:
```sh
$ sbatch myscript.sh [script-options] [script-args]
```

- Monitor your jobs:
```bash
$ squeue -u <username>
```

---

## Some common `sbatch` options:

```sh
#SBATCH --nodes=<N>
#SBATCH --ntasks-per-node=<N>
#SBATCH --time=HH:MM:SS
#SBATCH --mem=Xgb               # Default is Mb, hence "gb" specification
#SBATCH --job-name=<myjobname>
#SBATCH --account=<projectID>
```

--- 

## Some more advanced `sbatch` options:

```sh
--begin=2020-10-20T12:00:00
```

---
